@if (Config.AuthorizationProviders.Facebook.IsDefined)
{
    <script src="http://static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php/@(System.Threading.Thread.CurrentThread.CurrentUICulture)" type="text/javascript"></script>
    <script type="text/javascript">
        FB.init('@Config.AuthorizationProviders.Facebook.ApiKey', '@Url.Action("FacebookReceiver", "Authentication")');
    </script>
}
<ul id="userMenu">
    <li class="toContent"><a href="#content" accesskey="1">Go to content</a></li>
	@if (User == null)
	{
        if (Config.AuthorizationProviders.Facebook.IsDefined)
        {
		<li class="login">@Html.Partial("ButtonFacebook", new{size="small"}, true)</li>
        }
		if (Config.AuthorizationProviders.Twitter.IsDefined)
		{
		<li class="login">@Html.Partial("ButtonTwitter", new{size="small"}, true)</li>
		}
		if (Config.AuthorizationProviders.FormsAuth.IsDefined)
		{
		<li class="login">@Html.ActionLink("Sign In", "Login", "Authentication", new{returnUrl = ViewBag.ReturnUrl ?? Request.Url.PathAndQuery}, null)</li>
		}
    }
    else
	{
		if (this.User.Group >= UserGroup.Moderator)
		{
			<li class="admin">@Html.ActionLink("Admin dashboard", "Dashboard", "Admin")</li>
		}		
		<li class="userName">@Html.ActionLink(this.User.UserName, "Detail", "Users", new { id = User.Id }, null)</li>
		<li class="logged">@Html.ActionLink("Account", "Edit", "Users", new { id = User.Id }, null)</li>
		if (this.User.Provider == AuthenticationProvider.Facebook)
		{
			<li class="logout"><a href="#" onclick="FB.Connect.logoutAndRedirect('@Url.Action("Logout", "Authentication", new { returnUrl = Request.Url.PathAndQuery })');return false;">Logout</a></li>
		}
		else
		{
			<li class="logout">@Html.ActionLink("Logout", "Logout", "Authentication")</li>
		}
	}
</ul>
